models:
  - name: fct_flights
    description: Рейсы
    columns:
      - name: aircraft_code
        tests:
          - dbt_utils.not_empty_string:
              trim_whitespace: False
      - name: departure_airport
        description: Аэропорт отправления
        tests:
          - not_null
          - relationships:
              to: ref('dim_airports')
              field: airport_code
      - name: arrival_airport
        description: Аэропорт прибытия
        tests:
          - not_null
          - relationships:
              to: ref('dim_airports')
              field: airport_code
      - name: status
        description: Статус рейса
        tests:
          - not_null
          - accepted_values: 
              values: ['On Time', 'Delayed', 'Departed', 'Arrived', 'Scheduled', 'Cancelled']
  - name: fct_bookings
    description: Факты Бронирования
    docs:
      show: true
      node_color: red
    latest_version: 1
    versions:
      - v: 1
    deprication_date: 2026-01-01 00:00:00.00+00:00
    access: protected
    config:
      contract: {enforced: true}
    meta: 
      owner: alexuu@mail.ru
      status: work
    columns:
      - name: book_ref
        data_type: varchar(8)
        constraints:
          - type: not_null
      - name: book_date
        data_type: timestamptz
        quote: true
      - name: total_amount
        data_type: numeric(10, 2)
        constraints:
          - type: check
            expression: 'total_amount >= 0'
        tests:
          - not_null
        meta: { type: 'money' }
#        tags:
        granularity:
    tags: t1
    time_spine:
#      standart_granularity_column: 
    constraints:
      - type: primary_key
        columns: [book_ref]
#        name: pk_bookings_book_ref
    
#      - type: unique
#      - type: foreign_key
#        columns: [book_ref]
#        to: ref('fct_bookings')
#        to_columns: [book_ref]
#      - type: check
#        columns: [total_amount]
#        expression: 'total_amount >= 0'
#        name: ck_bookings_total_amount